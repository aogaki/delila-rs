# DELILA DAQ Configuration
# Multi-emulator test configuration

# =============================================================================
# Operator Settings
# =============================================================================

[operator]
# Experiment name (server-authoritative, not editable by UI)
# This is used to filter run numbers in MongoDB
experiment_name = "TestExp"

# =============================================================================
# Network Topology
# =============================================================================

[network]
cluster_name = "daq-cluster-1"

# Data sources (emulators or real digitizers)
# id = module number (0-indexed)
# pipeline_order: Start順=降順, Stop順=昇順 (1=upstream, 3=downstream)
# Start: downstream first (3→1), Stop: upstream first (1→3)
[[network.sources]]
id = 0
name = "digitizer-0"
bind = "tcp://*:5555"
command = "tcp://*:5560"
pipeline_order = 1

[[network.sources]]
id = 1
name = "digitizer-1"
bind = "tcp://*:5556"
command = "tcp://*:5561"
pipeline_order = 1
#digitizer_url = "dig2://172.18.4.56"
#module_id = 1
#time_step_ns = 2.0

# Merger: receives from all sources, publishes merged stream
[network.merger]
subscribe = ["tcp://localhost:5555", "tcp://localhost:5556"]
publish = "tcp://*:5557"
command = "tcp://*:5570"
pipeline_order = 2

# Recorder: writes data to disk
[network.recorder]
subscribe = "tcp://localhost:5557"
command = "tcp://*:5580"
output_dir = "./data"
pipeline_order = 3

# Monitor: web interface for live monitoring
[network.monitor]
subscribe = "tcp://localhost:5557"
command = "tcp://*:5590"
http_port = 8081
pipeline_order = 3

# =============================================================================
# Operational Settings
# =============================================================================

[settings]
source = "file"

[settings.file]
events_per_batch = 1000    # 500 events/batch
batch_interval_ms = 0    # 10ms = 100 batches/s per source
num_modules = 2
channels_per_module = 16
enable_waveform = false    # true: generate waveform for all events
waveform_probes = 3       # Bitmask: 1=analog1, 2=analog2, 3=both analog, 63=all probes
waveform_samples = 512    # Number of samples (real experiments: 2000-10000)

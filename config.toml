# DELILA DAQ Configuration

[operator]
experiment_name = "TestExp"

# =============================================================================
# Network Topology
# =============================================================================

[network]
# Data sources
# type: emulator, psd1, psd2, pha1, zle
# pipeline_order: Start順=降順, Stop順=昇順 (1=upstream, 3=downstream)
# Emulator source (for testing without hardware)
[[network.sources]]
id = 0
name = "emulator-0"
type = "emulator"
bind = "tcp://*:5555"
command = "tcp://*:5560"
pipeline_order = 1

# Real PSD2 digitizer (uncomment to use)
# [[network.sources]]
# id = 1
# name = "psd2-real"
# type = "psd2"
# bind = "tcp://*:5556"
# command = "tcp://*:5561"
# digitizer_url = "dig2://172.18.4.56"
# config_file = "config/digitizers/psd2_test.json"
# pipeline_order = 1

[[network.sources]]
id = 1
name = "emulator-1"
type = "emulator"
bind = "tcp://*:5556"
command = "tcp://*:5561"
pipeline_order = 1

# Merger: receives from all sources, publishes merged stream
[network.merger]
subscribe = ["tcp://localhost:5555", "tcp://localhost:5556"]
publish = "tcp://*:5557"
command = "tcp://*:5570"
pipeline_order = 2

# Recorder: writes data to disk
[network.recorder]
subscribe = "tcp://localhost:5557"
command = "tcp://*:5580"
output_dir = "./data"
pipeline_order = 3

# Monitor: web interface for live monitoring
[network.monitor]
subscribe = "tcp://localhost:5557"
command = "tcp://*:5590"
http_port = 8081
pipeline_order = 3

# =============================================================================
# Emulator Settings (runtime-configurable via Web UI)
# =============================================================================

[settings.file]
events_per_batch = 5000
batch_interval_ms = 0
num_modules = 2
channels_per_module = 16
enable_waveform = false
waveform_probes = 3
waveform_samples = 512
